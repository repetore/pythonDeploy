{% extends 'base.html' %}

{% block content %}
<h1>Профиль</h1>

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {% if user.photo %}
    <p><img src="{{ user.photo.url }}">
    {% else %}
    <p><img src="{{ default_image }}">
    {% endif %}

    <div class="form-error">{{ form.non_field_errors }}</div>
    {% for f in form %}
    <p><label class="form-label" for="{{ f.id_for_label }}">{{f.label}}: </label>{{ f }}</p>
    <div class="form-error">{{ f.errors }}</div>
    {% endfor %}

    <p><button type="submit" id="edit_profile">Сохранить</button></p>
</form>
{% block scripts %}
<script>
document.addEventListener("DOMContentLoaded", function() {
    const btn = document.getElementById("edit_profile");

    if (btn) {
        btn.addEventListener("click", function() {
            if (window.top100Counter && typeof top100Counter.trackEvent === "function") {
                top100Counter.trackEvent("edit_profile");
            }
        });
    }
});
</script>
{% endblock %}
<hr>
<p><a href="{% url 'users:password_change' %}">Сменить пароль</a></p>

{% endblock %}
